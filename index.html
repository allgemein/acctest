<!DOCTYPE html>
<html lang="ja">
  <div id="txt"></div>
  <div id="liq"></div>
  <button onclick="requestPermission()">iOS13以上の人はここを押してください</button>
  <!-- <input type="range" min="1" max="100" id="limen"> -->
  <style>
#liq {
  position: absolute;
  bottom: 0px;
  width: 100vw;
  height: 0px;
  background-color: orange;
}
  </style>
  <script>
    var limen = 5;
var count = 0;
// document.getElementById("limen").addEventListener("input",updateLimen);
// function updateLimen(e){limen = e.target.value;}
requestPermission = ()=> {
  DeviceMotionEvent.requestPermission().then(response => {
    if (response === 'granted') {
      window.addEventListener("devicemotion", (dat) => {
        let txt = document.getElementById("txt");
        // txt.innerHTML = `x:${dat.acceleration.x} y:${dat.acceleration.y} z:${dat.acceleration.z}`;
        var {x, y, z}=dat.acceleration;
        if(Math.abs(x) + Math.abs(y) + Math.abs(z) > limen){
          count++;
          document.getElementById("liq").style.height = count+"px";
          // txt.innerHTML = `${count}回振りました`;
        }
      });
    }
  }).catch(console.error);
};

setInterval(decCount, 100);

function decCount(){
  if(count>10){
    count-=10;
    document.getElementById("liq").style.height = count+"px";
  }
}
</script>
